<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Task Manager</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 10px; background: #f9f9f9; }
    table { width: 100%; border-collapse: collapse; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #4CAF50; color: white; }
    tr:nth-child(even) { background: #f2f2f2; }
    a { color: #007bff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    @media (max-width: 600px) {
      body { font-size: 18px; }
      th, td { padding: 12px; }
    }
  </style>
</head>
<body>
  <h1>Active Tasks</h1>
  <table id="tasks-table">
    <thead>
      <tr><th>â‚½</th><th>Task</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadTasks() {
      try {
        const resp = await fetch('tasks.json', { cache: 'no-store' });
        const tasks = await resp.json();
        const tbody = document.querySelector('#tasks-table tbody');
        tbody.innerHTML = '';

        tasks
          .filter(t => !t.IsNotWorking)
          .forEach(t => {
            const tr = document.createElement('tr');

            // Price formatting: no trailing .00 if integer
            let price = t.Price;
            let priceText = (Number.isInteger(price)) ? price : price;

            const tdPrice = document.createElement('td');
            tdPrice.textContent = priceText;

            const tdTask = document.createElement('td');
            const a = document.createElement('a');
            a.href = t.TaskLink || '#';
            a.textContent = t.TaskName || '(No Name)';
            a.target = '_blank';
            tdTask.appendChild(a);

            tr.appendChild(tdPrice);
            tr.appendChild(tdTask);
            tbody.appendChild(tr);
          });
      } catch (e) {
        console.error('Failed loading tasks.json', e);
      }
    }

    loadTasks();
    // optional: refresh every minute
    setInterval(loadTasks, 60000);
  </script>
</body>
</html>
